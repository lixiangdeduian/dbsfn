# 计划：支持按用户视角的对象访问（如医生查看“我的排班”）

1. 梳理现状：梳理 schema 中与用户/医生关联的表视图（如排班表），确认当前基于角色的菜单和 `/api/objects/:name` 无法区分具体用户的原因与数据关联字段（doctor_id、user_id 等）。
2. 身份输入与传递：在前端增加“当前用户”输入/下拉（可选预置用户），并在所有 API 请求（角色菜单、对象数据、插入/更新）中携带 `user` 参数，用于后端做行级过滤。
3. 后端扩展：为 `/api/menu`、`/api/objects/:name` 及插入/更新接口增加可选 `user` 参数，校验并绑定到 session/transaction，按需调用存储过程或在查询里追加 `WHERE <owner_field>=:user` 以返回“我的”数据，同时在可见菜单中过滤出仅与该用户相关的表/视图。
4. 前端过滤与文案：对象视图请求附带 `user`，在 UI 中标注“我的数据”状态；若未填写用户则退回当前角色视角，并提示需要输入用户以查看个人数据。
5. 验证：使用多个角色/用户组合手动验证——医生查看自己排班能看到数据，换另一个用户看不到；插入/更新仍受角色权限控制且自动带上用户关联字段（避免越权）。
6. 默认用户预填：首次加载时从后端返回各角色的推荐用户（含管理员/所有角色），前端自动选中并随请求携带，无需手动填写；提供快速切换下拉但保持默认即可直接查看“我的”数据。
